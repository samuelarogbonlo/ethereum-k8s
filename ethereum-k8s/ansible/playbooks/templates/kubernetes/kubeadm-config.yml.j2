apiVersion: kubeadm.k8s.io/v1beta3
kind: InitConfiguration
nodeRegistration:
  criSocket: "unix:///var/run/containerd/containerd.sock"
---
apiVersion: kubeadm.k8s.io/v1beta3
kind: ClusterConfiguration
kubernetesVersion: v{{ kubernetes_version }}
networking:
  podSubnet: {{ pod_network_cidr }}
  serviceSubnet: {{ kubernetes_service_cidr }}
controllerManager:
  extraArgs:
    node-monitor-grace-period: "20s"
    node-monitor-period: "10s"
scheduler:
  extraArgs:
    address: 0.0.0.0
etcd:
  local:
    dataDir: /var/lib/etcd
---
apiVersion: kubelet.config.k8s.io/v1beta1
kind: KubeletConfiguration
cgroupDriver: {{ kubernetes_cgroup_driver }}
systemReserved:
  cpu: 500m
  memory: 1Gi
kubeReserved:
  cpu: 500m
  memory: 1Gi
evictionHard:
  memory.available: "5%"
  nodefs.available: "10%"
  nodefs.inodesFree: "5%"
  imagefs.available: "15%"